digraph vocab_metamodel_diagram {

    ratio="fill";
    node [shape=record style=rounded fontsize=14];

    subgraph cluster_1 {

        label="vocab";

        concept [label="{concept|\
        <pk> id [PK: serial] |\
        <pid> parent_id [FK] (supertype relation) |\
        <sid> synonym_id [FK] (null indicates canonical concept) |\
        code [PK: text] (identifier from source vocabulary) |\
        term [PK: text] (meaningful name of the concept) |\
        description [text] (if available, description of the concept) |\
        uri [uri] (uri or iri of the concept) |\
        valid_start_date [date] |\
        valid_end_date [date] |\
        <ir> invalid_reason [FK] |\
        }"];
        concept -> concept [label="parent"];
        concept -> concept [label="synonym"];
        concept -> invalid_reason [label="invalid_reason"];

        invalid_reason [label="{invalid_reason|\
        <pk> reason [PK: text] (deleted, updated) |\
        }"];

        /* Begin Notes section
        */
        node [shape=note style=filled fillcolor=yellow];
        edge [arrowhead=none];

        note_con [label="One 'concept' table per vocabulary.\l\Must be annotated with\l\'tag:misd.isi.edu,2015:vocabulary'."];
        note_con -> concept;

        note_dom [label="This is a simple domain table."];
        note_dom -> invalid_reason [arrowhead=none];
    }
}
